<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mapi::Pst::RawPropertyStore
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mapi::Pst::RawPropertyStore";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (R)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Mapi.html" title="Mapi (module)">Mapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Pst.html" title="Mapi::Pst (class)">Pst</a></span></span>
     &raquo; 
    <span class="title">RawPropertyStore</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mapi::Pst::RawPropertyStore
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'>BlockParser</span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'>BlockParser</span></li>
          
            <li class="next">Mapi::Pst::RawPropertyStore</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>Enumerable</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mapi/pst.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>RawPropertyStore is used to iterate through the properties of an item, or the auxiliary
data for an attachment. its just a parser for the way the properties are serialized, when the
properties donâ€™t have to conform to a column structure.</p>

<p>structure of this chunk of data is often
  header, property keys, data values, and then indexes.
the property keys has value in it. value can be the actual value if its a short type,
otherwise you lookup the value in the indicies, where you get the offsets to use in the
main data body. due to the indirect thing though, any of these parts could actually come
from a separate stream.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#length-instance_method" title="#length (instance method)">#<strong>length</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Number of property tuples.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each-instance_method" title="#each (instance method)">#<strong>each</strong> {|key, type, value| ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>iterate through the property tuples.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(node, local_node_id = USE_MAIN_DATA)  &#x21d2; RawPropertyStore </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Will read Property Context (PC).</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(node, local_node_id = USE_MAIN_DATA)  &#x21d2; <tt><span class='object_link'><a href="" title="Mapi::Pst::RawPropertyStore (class)">RawPropertyStore</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Will read Property Context (PC)</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>desc</span>
      
      
        <span class='type'>(<tt><span class='object_link'>NodePtr</span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>local_node_id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>USE_MAIN_DATA</tt>)</em>
      
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-pst/294c83c6-ff92-42f5-b6b6-876c29fa9737" target="_parent" title="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-pst/294c83c6-ff92-42f5-b6b6-876c29fa9737">https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-pst/294c83c6-ff92-42f5-b6b6-876c29fa9737</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1316</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_node'>node</span><span class='comma'>,</span> <span class='id identifier rubyid_local_node_id'>local_node_id</span> <span class='op'>=</span> <span class='const'>USE_MAIN_DATA</span>
	<span class='kw'>super</span>
	<span class='id identifier rubyid_bTypePC'>bTypePC</span> <span class='op'>=</span> <span class='int'>0xbc</span>
	<span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expected type 188 - got </span><span class='embexpr_beg'>#{</span><span class='ivar'>@heap_type</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='ivar'>@heap_type</span> <span class='op'>==</span> <span class='id identifier rubyid_bTypePC'>bTypePC</span>

	<span class='comment'># the way that offset works, data1 may be a subset of buf, or something from id2. if its from buf,
</span>	<span class='comment'># it will be offset based on index_offset and offset. so it could be some random chunk of data anywhere
</span>	<span class='comment'># in the thing.
</span>	<span class='id identifier rubyid_header_data'>header_data</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data_indirect'>get_data_indirect</span> <span class='ivar'>@offset1</span>
	<span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></span> <span class='kw'>if</span> <span class='id identifier rubyid_header_data'>header_data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='int'>8</span>
	<span class='id identifier rubyid_signature'>signature</span><span class='comma'>,</span> <span class='id identifier rubyid_offset2'>offset2</span> <span class='op'>=</span> <span class='id identifier rubyid_header_data'>header_data</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V2</span><span class='tstring_end'>&#39;</span></span>
	<span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>invalid Property Context signature 0x%08x</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='ivar'>@type</span> <span class='kw'>if</span> <span class='id identifier rubyid_signature'>signature</span> <span class='op'>!=</span> <span class='int'>0x000602b5</span>
	<span class='comment'># this is actually a big chunk of tag tuples.
</span>	<span class='ivar'>@index_data</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data_indirect'>get_data_indirect</span> <span class='id identifier rubyid_offset2'>offset2</span>
	<span class='ivar'>@length</span> <span class='op'>=</span> <span class='ivar'>@index_data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>/</span> <span class='int'>8</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="length-instance_method">
  
    #<strong>length</strong>  &#x21d2; <tt>Integer</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns number of property tuples.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>number of property tuples</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1309
1310
1311</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1309</span>

<span class='kw'>def</span> <span class='id identifier rubyid_length'>length</span>
  <span class='ivar'>@length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="each-instance_method">
  
    #<strong>each</strong> {|key, type, value| ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>iterate through the property tuples</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>key</tt>, <tt>type</tt>, <tt>value</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1339
1340
1341
1342
1343
1344</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1339</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each'>each</span>
	<span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
		<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_handle_indirect_values'>handle_indirect_values</span><span class='lparen'>(</span><span class='op'>*</span><span class='ivar'>@index_data</span><span class='lbracket'>[</span><span class='int'>8</span> <span class='op'>*</span> <span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='int'>8</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>vvV</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
		<span class='kw'>yield</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Dec 25 18:00:08 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.6.5).
</div>

    </div>
  </body>
</html>