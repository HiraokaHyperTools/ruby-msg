<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mapi::Pst::RawPropertyStoreTable
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mapi::Pst::RawPropertyStoreTable";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (R)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Mapi.html" title="Mapi (module)">Mapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Pst.html" title="Mapi::Pst (class)">Pst</a></span></span>
     &raquo; 
    <span class="title">RawPropertyStoreTable</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mapi::Pst::RawPropertyStoreTable
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="BlockParser.html" title="Mapi::Pst::BlockParser (class)">BlockParser</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="BlockParser.html" title="Mapi::Pst::BlockParser (class)">BlockParser</a></span></li>
          
            <li class="next">Mapi::Pst::RawPropertyStoreTable</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>Enumerable</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mapi/pst.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>RawPropertyStoreTable is kind of like a database table. it has a fixed set of columns. #[] is kind of like getting a row from the table. those rows are currently encapsulated by Row, which has #each like RawPropertyStore. only used for the recipients array, and the attachments array. completely lazy, doesn&#39;t load any of the properties upon creation.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="RawPropertyStoreTable/Column.html" title="Mapi::Pst::RawPropertyStoreTable::Column (class)">Column</a></span>, <span class='object_link'><a href="RawPropertyStoreTable/Row.html" title="Mapi::Pst::RawPropertyStoreTable::Row (class)">Row</a></span>
    
  
</p>



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants inherited
     from <span class='object_link'><a href="BlockParser.html" title="Mapi::Pst::BlockParser (class)">BlockParser</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="BlockParser.html#ID2_ATTACHMENTS-constant" title="Mapi::Pst::BlockParser::ID2_ATTACHMENTS (constant)">BlockParser::ID2_ATTACHMENTS</a></span>, <span class='object_link'><a href="BlockParser.html#ID2_RECIPIENTS-constant" title="Mapi::Pst::BlockParser::ID2_RECIPIENTS (constant)">BlockParser::ID2_RECIPIENTS</a></span>, <span class='object_link'><a href="BlockParser.html#IMMEDIATE_TYPES-constant" title="Mapi::Pst::BlockParser::IMMEDIATE_TYPES (constant)">BlockParser::IMMEDIATE_TYPES</a></span>, <span class='object_link'><a href="BlockParser.html#INDIRECT_TYPES-constant" title="Mapi::Pst::BlockParser::INDIRECT_TYPES (constant)">BlockParser::INDIRECT_TYPES</a></span>, <span class='object_link'><a href="BlockParser.html#PR_BODY_HTML-constant" title="Mapi::Pst::BlockParser::PR_BODY_HTML (constant)">BlockParser::PR_BODY_HTML</a></span>, <span class='object_link'><a href="BlockParser.html#PR_SUBJECT-constant" title="Mapi::Pst::BlockParser::PR_SUBJECT (constant)">BlockParser::PR_SUBJECT</a></span>, <span class='object_link'><a href="BlockParser.html#TYPES-constant" title="Mapi::Pst::BlockParser::TYPES (constant)">BlockParser::TYPES</a></span></p>


  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#data2-instance_method" title="#data2 (instance method)">#<strong>data2</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute data2.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#data3-instance_method" title="#data3 (instance method)">#<strong>data3</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute data3.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#index_data-instance_method" title="#index_data (instance method)">#<strong>index_data</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute index_data.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#length-instance_method" title="#length (instance method)">#<strong>length</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute length.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#rec_size-instance_method" title="#rec_size (instance method)">#<strong>rec_size</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute rec_size.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="BlockParser.html" title="Mapi::Pst::BlockParser (class)">BlockParser</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="BlockParser.html#data-instance_method" title="Mapi::Pst::BlockParser#data (method)">#data</a></span>, <span class='object_link'><a href="BlockParser.html#data_chunks-instance_method" title="Mapi::Pst::BlockParser#data_chunks (method)">#data_chunks</a></span>, <span class='object_link'><a href="BlockParser.html#desc-instance_method" title="Mapi::Pst::BlockParser#desc (method)">#desc</a></span>, <span class='object_link'><a href="BlockParser.html#offset_tables-instance_method" title="Mapi::Pst::BlockParser#offset_tables (method)">#offset_tables</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#[]-instance_method" title="#[] (instance method)">#<strong>[]</strong>(idx)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each-instance_method" title="#each (instance method)">#<strong>each</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(desc)  &#x21d2; RawPropertyStoreTable </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of RawPropertyStoreTable.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#schema-instance_method" title="#schema (instance method)">#<strong>schema</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="BlockParser.html" title="Mapi::Pst::BlockParser (class)">BlockParser</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="BlockParser.html#get_data_indirect-instance_method" title="Mapi::Pst::BlockParser#get_data_indirect (method)">#get_data_indirect</a></span>, <span class='object_link'><a href="BlockParser.html#get_data_indirect_io-instance_method" title="Mapi::Pst::BlockParser#get_data_indirect_io (method)">#get_data_indirect_io</a></span>, <span class='object_link'><a href="BlockParser.html#handle_indirect_values-instance_method" title="Mapi::Pst::BlockParser#handle_indirect_values (method)">#handle_indirect_values</a></span>, <span class='object_link'><a href="BlockParser.html#idx2-instance_method" title="Mapi::Pst::BlockParser#idx2 (method)">#idx2</a></span>, <span class='object_link'><a href="BlockParser.html#load_header-instance_method" title="Mapi::Pst::BlockParser#load_header (method)">#load_header</a></span></p>

  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(desc)  &#x21d2; <tt><span class='object_link'><a href="" title="Mapi::Pst::RawPropertyStoreTable (class)">RawPropertyStoreTable</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of RawPropertyStoreTable.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380
1381
1382
1383
1384
1385
1386
1387
1388
1389
1390
1391
1392
1393
1394
1395
1396
1397</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1334</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_desc'>desc</span>
	<span class='kw'>super</span>
	<span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expected type 2 - got </span><span class='embexpr_beg'>#{</span><span class='ivar'>@type</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='ivar'>@type</span> <span class='op'>==</span> <span class='int'>2</span>

	<span class='id identifier rubyid_header_data'>header_data</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data_indirect'>get_data_indirect</span> <span class='ivar'>@offset1</span>
	<span class='comment'># seven_c_blk
</span>	<span class='comment'># often: u1 == u2 and u3 == u2 + 2, then rec_size == u3 + 4. wtf
</span>	<span class='id identifier rubyid_seven_c'>seven_c</span><span class='comma'>,</span> <span class='ivar'>@num_list</span><span class='comma'>,</span> <span class='id identifier rubyid_u1'>u1</span><span class='comma'>,</span> <span class='id identifier rubyid_u2'>u2</span><span class='comma'>,</span> <span class='id identifier rubyid_u3'>u3</span><span class='comma'>,</span> <span class='ivar'>@rec_size</span><span class='comma'>,</span> <span class='id identifier rubyid_b_five_offset'>b_five_offset</span><span class='comma'>,</span>
		<span class='id identifier rubyid_ind2_offset'>ind2_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_u7'>u7</span><span class='comma'>,</span> <span class='id identifier rubyid_u8'>u8</span> <span class='op'>=</span> <span class='id identifier rubyid_header_data'>header_data</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>22</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CCv4V2v2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
	<span class='ivar'>@index_data</span> <span class='op'>=</span> <span class='id identifier rubyid_header_data'>header_data</span><span class='lbracket'>[</span><span class='int'>22</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>

	<span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></span> <span class='kw'>if</span> <span class='ivar'>@num_list</span> <span class='op'>!=</span> <span class='id identifier rubyid_schema'>schema</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='kw'>or</span> <span class='id identifier rubyid_seven_c'>seven_c</span> <span class='op'>!=</span> <span class='int'>0x7c</span>
	<span class='comment'># another check
</span>	<span class='id identifier rubyid_min_size'>min_size</span> <span class='op'>=</span> <span class='id identifier rubyid_schema'>schema</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_total'>total</span><span class='comma'>,</span> <span class='id identifier rubyid_col'>col</span><span class='op'>|</span> <span class='id identifier rubyid_total'>total</span> <span class='op'>+</span> <span class='id identifier rubyid_col'>col</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='rbrace'>}</span>
	<span class='comment'># seem to have at max, 8 padding bytes on the end of the record. not sure if it means
</span>	<span class='comment'># anything. maybe its just space that hasn&#39;t been reclaimed due to columns being
</span>	<span class='comment'># removed or something. probably should just check lower bound. 
</span>	<span class='id identifier rubyid_range'>range</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_min_size'>min_size</span><span class='op'>..</span><span class='id identifier rubyid_min_size'>min_size</span> <span class='op'>+</span> <span class='int'>8</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rec_size seems wrong (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_range'>range</span><span class='embexpr_end'>}</span><span class='tstring_content'> !=== </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rec_size'>rec_size</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_range'>range</span> <span class='op'>===</span> <span class='id identifier rubyid_rec_size'>rec_size</span>

	<span class='id identifier rubyid_header_data2'>header_data2</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data_indirect'>get_data_indirect</span> <span class='id identifier rubyid_b_five_offset'>b_five_offset</span>
	<span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></span> <span class='kw'>if</span> <span class='id identifier rubyid_header_data2'>header_data2</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='int'>8</span>
	<span class='id identifier rubyid_signature'>signature</span><span class='comma'>,</span> <span class='id identifier rubyid_offset2'>offset2</span> <span class='op'>=</span> <span class='id identifier rubyid_header_data2'>header_data2</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V2</span><span class='tstring_end'>&#39;</span></span>
	<span class='comment'># ??? seems a bit iffy
</span>	<span class='comment'># there&#39;s probably more to the differences than this, and the data2 difference below
</span>	<span class='id identifier rubyid_expect'>expect</span> <span class='op'>=</span> <span class='id identifier rubyid_desc'>desc</span><span class='period'>.</span><span class='id identifier rubyid_pst'>pst</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_version_2003?'>version_2003?</span> <span class='op'>?</span> <span class='int'>0x000404b5</span> <span class='op'>:</span> <span class='int'>0x000204b5</span>
	<span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="FormatError.html" title="Mapi::Pst::FormatError (class)">FormatError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unhandled block signature 0x%08x</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_signature'>signature</span> <span class='kw'>if</span> <span class='id identifier rubyid_signature'>signature</span> <span class='op'>!=</span> <span class='id identifier rubyid_expect'>expect</span>

	<span class='comment'># this holds all the row data
</span>	<span class='comment'># handle multiple block issue.
</span>	<span class='ivar'>@data3_io</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data_indirect_io'>get_data_indirect_io</span> <span class='id identifier rubyid_ind2_offset'>ind2_offset</span>
	<span class='kw'>if</span> <span class='const'><span class='object_link'><a href="RangesIOIdxChain.html" title="Mapi::Pst::RangesIOIdxChain (class)">RangesIOIdxChain</a></span></span> <span class='op'>===</span> <span class='ivar'>@data3_io</span>
		<span class='ivar'>@data3_idxs</span> <span class='op'>=</span> 
		<span class='comment'># modify ranges
</span>		<span class='id identifier rubyid_ranges'>ranges</span> <span class='op'>=</span> <span class='ivar'>@data3_io</span><span class='period'>.</span><span class='id identifier rubyid_ranges'>ranges</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>/</span> <span class='ivar'>@rec_size</span> <span class='op'>*</span> <span class='ivar'>@rec_size</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
		<span class='ivar'>@data3_io</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@ranges</span><span class='comma'>,</span> <span class='id identifier rubyid_ranges'>ranges</span>
	<span class='kw'>end</span>
	<span class='ivar'>@data3</span> <span class='op'>=</span> <span class='ivar'>@data3_io</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>

	<span class='comment'># there must be something to the data in data2. i think data2 is the array of objects essentially.
</span>	<span class='comment'># currently its only used to imply a length
</span>	<span class='comment'># actually, at size 6, its just some auxiliary data. i&#39;m thinking either Vv/vV, for 97, and something
</span>	<span class='comment'># wider for 03. the second value is just the index (0...length), and the first value is
</span>	<span class='comment'># some kind of offset i expect. actually, they were all id2 values, in another case.
</span>	<span class='comment'># so maybe they&#39;re get_data_indirect values too?
</span>	<span class='comment'># actually, it turned out they were identical to the PR_ATTACHMENT_ID2 values...
</span>	<span class='comment'># id2_values = ie, data2.unpack(&#39;v*&#39;).to_enum(:each_slice, 3).transpose[0]
</span>	<span class='comment'># table[i].assoc(PR_ATTACHMENT_ID2).last == id2_values[i], for all i. 
</span>	<span class='ivar'>@data2</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data_indirect'>get_data_indirect</span><span class='lparen'>(</span><span class='id identifier rubyid_offset2'>offset2</span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
	<span class='comment'>#if data2
</span>	<span class='comment'>#	@length = (data2.length / 6.0).ceil
</span>	<span class='comment'>#else
</span>	<span class='comment'># the above / 6, may have been ok for 97 files, but the new 0x0004 style block must have
</span>	<span class='comment'># different size records... just use this instead:
</span>		<span class='comment'># hmmm, actually, we can still figure it out:
</span>		<span class='ivar'>@length</span> <span class='op'>=</span> <span class='ivar'>@data3</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>/</span> <span class='ivar'>@rec_size</span>
	<span class='comment'>#end
</span>
	<span class='comment'># lets try and at least use data2 for a warning for now
</span>	<span class='kw'>if</span> <span class='id identifier rubyid_data2'>data2</span>
		<span class='id identifier rubyid_data2_rec_size'>data2_rec_size</span> <span class='op'>=</span> <span class='id identifier rubyid_desc'>desc</span><span class='period'>.</span><span class='id identifier rubyid_pst'>pst</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_version_2003?'>version_2003?</span> <span class='op'>?</span> <span class='int'>8</span> <span class='op'>:</span> <span class='int'>6</span>
		<span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>somthing seems wrong with data3</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='ivar'>@length</span> <span class='op'>==</span> <span class='lparen'>(</span><span class='id identifier rubyid_data2'>data2</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>/</span> <span class='id identifier rubyid_data2_rec_size'>data2_rec_size</span><span class='rparen'>)</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="data2-instance_method">
  
    #<strong>data2</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute data2.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1333
1334
1335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1333</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data2'>data2</span>
  <span class='ivar'>@data2</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="data3-instance_method">
  
    #<strong>data3</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute data3.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1333
1334
1335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1333</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data3'>data3</span>
  <span class='ivar'>@data3</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="index_data-instance_method">
  
    #<strong>index_data</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute index_data.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1333
1334
1335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1333</span>

<span class='kw'>def</span> <span class='id identifier rubyid_index_data'>index_data</span>
  <span class='ivar'>@index_data</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="length-instance_method">
  
    #<strong>length</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute length.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1333
1334
1335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1333</span>

<span class='kw'>def</span> <span class='id identifier rubyid_length'>length</span>
  <span class='ivar'>@length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="rec_size-instance_method">
  
    #<strong>rec_size</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute rec_size.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1333
1334
1335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1333</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rec_size'>rec_size</span>
  <span class='ivar'>@rec_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="[]-instance_method">
  
    #<strong>[]</strong>(idx)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1403
1404
1405
1406</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1403</span>

<span class='kw'>def</span> <span class='op'>[]</span> <span class='id identifier rubyid_idx'>idx</span>
	<span class='comment'># handle funky rounding
</span>	<span class='const'><span class='object_link'><a href="RawPropertyStoreTable/Row.html" title="Mapi::Pst::RawPropertyStoreTable::Row (class)">Row</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="RawPropertyStoreTable/Row.html#initialize-instance_method" title="Mapi::Pst::RawPropertyStoreTable::Row#initialize (method)">new</a></span></span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_idx'>idx</span> <span class='op'>*</span> <span class='ivar'>@rec_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each-instance_method">
  
    #<strong>each</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1408
1409
1410</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1408</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each'>each</span>
	<span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='kw'>yield</span> <span class='kw'>self</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="schema-instance_method">
  
    #<strong>schema</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1399
1400
1401</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1399</span>

<span class='kw'>def</span> <span class='id identifier rubyid_schema'>schema</span>
	<span class='ivar'>@schema</span> <span class='op'>||=</span> <span class='id identifier rubyid_index_data'>index_data</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.{8}</span><span class='regexp_end'>/m</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span> <span class='const'><span class='object_link'><a href="RawPropertyStoreTable/Column.html" title="Mapi::Pst::RawPropertyStoreTable::Column (class)">Column</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="RawPropertyStoreTable/Column.html#initialize-instance_method" title="Mapi::Pst::RawPropertyStoreTable::Column#initialize (method)">new</a></span></span> <span class='id identifier rubyid_data'>data</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Dec 22 13:41:59 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.6.5).
</div>

    </div>
  </body>
</html>