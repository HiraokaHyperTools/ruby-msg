<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mapi::Pst::Index64
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mapi::Pst::Index64";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (I)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Mapi.html" title="Mapi (module)">Mapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Pst.html" title="Mapi::Pst (class)">Pst</a></span></span>
     &raquo; 
    <span class="title">Index64</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mapi::Pst::Index64
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="Index.html" title="Mapi::Pst::Index (class)">Index</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Struct</li>
          
            <li class="next"><span class='object_link'><a href="Index.html" title="Mapi::Pst::Index (class)">Index</a></span></li>
          
            <li class="next">Mapi::Pst::Index64</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mapi/pst.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>will maybe inherit from Index64, in order to get the same #type function.</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="UNPACK_STR-constant" class="">UNPACK_STR =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TTvvV</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
        <dt id="SIZE-constant" class="">SIZE =
          
        </dt>
        <dd><pre class="code"><span class='int'>24</span></pre></dd>
      
        <dt id="BLOCK_SIZE-constant" class="">BLOCK_SIZE =
          
        </dt>
        <dd><pre class="code"><span class='int'>512</span></pre></dd>
      
        <dt id="COUNT_MAX-constant" class="">COUNT_MAX =
          <div class="docstring">
  <div class="discussion">
    
<p>bit of a guess really. 512 / 24 = 21, but doesn&#39;t leave enough header room</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>20</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#u2-instance_method" title="#u2 (instance method)">#<strong>u2</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>this is the extra item on the end of the UNPACK_STR above.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="Index.html" title="Mapi::Pst::Index (class)">Index</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Index.html#id-instance_method" title="Mapi::Pst::Index#id (method)">#id</a></span>, <span class='object_link'><a href="Index.html#offset-instance_method" title="Mapi::Pst::Index#offset (method)">#offset</a></span>, <span class='object_link'><a href="Index.html#pst-instance_method" title="Mapi::Pst::Index#pst (method)">#pst</a></span>, <span class='object_link'><a href="Index.html#size-instance_method" title="Mapi::Pst::Index#size (method)">#size</a></span>, <span class='object_link'><a href="Index.html#u1-instance_method" title="Mapi::Pst::Index#u1 (method)">#u1</a></span></p>


  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_chain-class_method" title="load_chain (class method)">.<strong>load_chain</strong>(io, header)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_idx_rec-class_method" title="load_idx_rec (class method)">.<strong>load_idx_rec</strong>(io, offset, linku1, start_val)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>almost identical to load code for Index, just different offsets and unpack strings.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(data)  &#x21d2; Index64 </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Index64.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Index.html" title="Mapi::Pst::Index (class)">Index</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Index.html#data%3F-instance_method" title="Mapi::Pst::Index#data? (method)">#data?</a></span>, <span class='object_link'><a href="Index.html#read-instance_method" title="Mapi::Pst::Index#read (method)">#read</a></span>, <span class='object_link'><a href="Index.html#type-instance_method" title="Mapi::Pst::Index#type (method)">#type</a></span></p>

  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(data)  &#x21d2; <tt><span class='object_link'><a href="" title="Mapi::Pst::Index64 (class)">Index64</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Index64.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


414
415
416
417
418</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 414</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_data'>data</span>
	<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Pst.html" title="Mapi::Pst (class)">Pst</a></span></span><span class='period'>.</span><span class='id identifier rubyid_unpack'><span class='object_link'><a href="../Pst.html#unpack-class_method" title="Mapi::Pst.unpack (method)">unpack</a></span></span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="#UNPACK_STR-constant" title="Mapi::Pst::Index64::UNPACK_STR (constant)">UNPACK_STR</a></span></span> <span class='kw'>if</span> <span class='const'>String</span> <span class='op'>===</span> <span class='id identifier rubyid_data'>data</span>
	<span class='ivar'>@u2</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span>
	<span class='kw'>super</span> <span class='id identifier rubyid_data'>data</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="u2=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="u2-instance_method">
  
    #<strong>u2</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>this is the extra item on the end of the UNPACK_STR above</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


412
413
414</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 412</span>

<span class='kw'>def</span> <span class='id identifier rubyid_u2'>u2</span>
  <span class='ivar'>@u2</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="load_chain-class_method">
  
    .<strong>load_chain</strong>(io, header)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


424
425
426</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 424</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_chain'>load_chain</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_header'>header</span>
	<span class='id identifier rubyid_load_idx_rec'>load_idx_rec</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_index1'>index1</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_idx_rec-class_method">
  
    .<strong>load_idx_rec</strong>(io, offset, linku1, start_val)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>almost identical to load code for Index, just different offsets and unpack strings. can probably merge them, or write a generic load_tree function or something.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 430</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_idx_rec'>load_idx_rec</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_linku1'>linku1</span><span class='comma'>,</span> <span class='id identifier rubyid_start_val'>start_val</span>
	<span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_seek'>seek</span> <span class='id identifier rubyid_offset'>offset</span>
	<span class='id identifier rubyid_buf'>buf</span> <span class='op'>=</span> <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='const'><span class='object_link'><a href="#BLOCK_SIZE-constant" title="Mapi::Pst::Index64::BLOCK_SIZE (constant)">BLOCK_SIZE</a></span></span>
	<span class='id identifier rubyid_idxs'>idxs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

	<span class='id identifier rubyid_item_count'>item_count</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Pst.html#ITEM_COUNT_OFFSET_64-constant" title="Mapi::Pst::ITEM_COUNT_OFFSET_64 (constant)">ITEM_COUNT_OFFSET_64</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_ord'>ord</span>
	<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>have too many active items in index (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_item_count'>item_count</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_item_count'>item_count</span> <span class='op'>&gt;</span> <span class='const'><span class='object_link'><a href="#COUNT_MAX-constant" title="Mapi::Pst::Index64::COUNT_MAX (constant)">COUNT_MAX</a></span></span>

	<span class='comment'>#idx = Index.new buf[BACKLINK_OFFSET, Index::SIZE]
</span>	<span class='comment'>#raise &#39;blah 1&#39; unless idx.id == linku1
</span>
	<span class='kw'>if</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Pst.html#LEVEL_INDICATOR_OFFSET_64-constant" title="Mapi::Pst::LEVEL_INDICATOR_OFFSET_64 (constant)">LEVEL_INDICATOR_OFFSET_64</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_ord'>ord</span> <span class='op'>==</span> <span class='int'>0</span>
		<span class='comment'># leaf pointers
</span>		<span class='comment'># split the data into item_count index objects
</span>		<span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="#SIZE-constant" title="Mapi::Pst::Index64::SIZE (constant)">SIZE</a></span></span> <span class='op'>*</span> <span class='id identifier rubyid_item_count'>item_count</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.{</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="#SIZE-constant" title="Mapi::Pst::Index64::SIZE (constant)">SIZE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>}</span><span class='regexp_end'>/mo</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
			<span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_data'>data</span>
			<span class='comment'># first entry
</span>			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>blah 3</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>==</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_start_val'>start_val</span> <span class='op'>!=</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_idx'>idx</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>!=</span> <span class='id identifier rubyid_start_val'>start_val</span>
			<span class='comment'>#idx.pst = self
</span>			<span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_idx'>idx</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>==</span> <span class='int'>0</span>
			<span class='id identifier rubyid_idxs'>idxs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_idx'>idx</span>
		<span class='kw'>end</span>
	<span class='kw'>else</span>
		<span class='comment'># node pointers
</span>		<span class='comment'># split the data into item_count table pointers
</span>		<span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="#SIZE-constant" title="Mapi::Pst::Index64::SIZE (constant)">SIZE</a></span></span> <span class='op'>*</span> <span class='id identifier rubyid_item_count'>item_count</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.{</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="#SIZE-constant" title="Mapi::Pst::Index64::SIZE (constant)">SIZE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>}</span><span class='regexp_end'>/mo</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
			<span class='id identifier rubyid_start'>start</span><span class='comma'>,</span> <span class='id identifier rubyid_u1'>u1</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Pst.html" title="Mapi::Pst (class)">Pst</a></span></span><span class='period'>.</span><span class='id identifier rubyid_unpack'><span class='object_link'><a href="../Pst.html#unpack-class_method" title="Mapi::Pst.unpack (method)">unpack</a></span></span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>T3</span><span class='tstring_end'>&#39;</span></span>
			<span class='comment'># for the first value, we expect the start to be equal
</span>			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>blah 3</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>==</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_start_val'>start_val</span> <span class='op'>!=</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_start'>start</span> <span class='op'>!=</span> <span class='id identifier rubyid_start_val'>start_val</span>
			<span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_start'>start</span> <span class='op'>==</span> <span class='int'>0</span>
			<span class='id identifier rubyid_idxs'>idxs</span> <span class='op'>+=</span> <span class='id identifier rubyid_load_idx_rec'>load_idx_rec</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_u1'>u1</span><span class='comma'>,</span> <span class='id identifier rubyid_start'>start</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>

	<span class='id identifier rubyid_idxs'>idxs</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


420
421
422</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 420</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
	<span class='kw'>super</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>&gt;$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, u2=%p&gt;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_u2'>u2</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Dec 22 21:41:52 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.6.5).
</div>

    </div>
  </body>
</html>