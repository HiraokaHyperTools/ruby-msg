<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mapi::Pst::Item
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mapi::Pst::Item";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (I)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Mapi.html" title="Mapi (module)">Mapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Pst.html" title="Mapi::Pst (class)">Pst</a></span></span>
     &raquo; 
    <span class="title">Item</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mapi::Pst::Item
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../Message.html" title="Mapi::Message (class)">Message</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../Item.html" title="Mapi::Item (class)">Item</a></span></li>
          
            <li class="next"><span class='object_link'><a href="../Message.html" title="Mapi::Message (class)">Message</a></span></li>
          
            <li class="next">Mapi::Pst::Item</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>RecursivelyEnumerable</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mapi/pst.rb</dd>
  </dl>
  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Item/EntryID.html" title="Mapi::Pst::Item::EntryID (class)">EntryID</a></span>
    
  
</p>



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants inherited
     from <span class='object_link'><a href="../Message.html" title="Mapi::Message (class)">Message</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Message.html#CONVERSION_MAP-constant" title="Mapi::Message::CONVERSION_MAP (constant)">Message::CONVERSION_MAP</a></span></p>


  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#parent-instance_method" title="#parent (instance method)">#<strong>parent</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute parent.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-instance_method" title="#type (instance method)">#<strong>type</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute type.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="../Item.html" title="Mapi::Item (class)">Item</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Item.html#properties-instance_method" title="Mapi::Item#properties (method)">#properties</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attachments-instance_method" title="#attachments (instance method)">#<strong>attachments</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>i think i will change these, so they can inherit the lazyness from RawPropertyStoreTable.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#children-instance_method" title="#children (instance method)">#<strong>children</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_child-instance_method" title="#each_child (instance method)">#<strong>each_child</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_recursive-instance_method" title="#each_recursive (instance method)">#<strong>each_recursive</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finder_entryid-instance_method" title="#finder_entryid (instance method)">#<strong>finder_entryid</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Search Root Record.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(desc, list, type = nil)  &#x21d2; Item </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Item.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ipm_subtree_entryid-instance_method" title="#ipm_subtree_entryid (instance method)">#<strong>ipm_subtree_entryid</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Top of Personal Folder Record.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ipm_wastebasket_entryid-instance_method" title="#ipm_wastebasket_entryid (instance method)">#<strong>ipm_wastebasket_entryid</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Deleted Items Folder Record.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#path-instance_method" title="#path (instance method)">#<strong>path</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#recipients-instance_method" title="#recipients (instance method)">#<strong>recipients</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../Message.html" title="Mapi::Message (class)">Message</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Message.html#body_to_mime-instance_method" title="Mapi::Message#body_to_mime (method)">#body_to_mime</a></span>, <span class='object_link'><a href="../Message.html#body_to_tmail-instance_method" title="Mapi::Message#body_to_tmail (method)">#body_to_tmail</a></span>, <span class='object_link'><a href="../Message.html#convert-instance_method" title="Mapi::Message#convert (method)">#convert</a></span>, <span class='object_link'><a href="../Message.html#headers-instance_method" title="Mapi::Message#headers (method)">#headers</a></span>, <span class='object_link'><a href="../Message.html#mime-instance_method" title="Mapi::Message#mime (method)">#mime</a></span>, <span class='object_link'><a href="../Message.html#mime_type-instance_method" title="Mapi::Message#mime_type (method)">#mime_type</a></span>, <span class='object_link'><a href="../Message.html#populate_headers-instance_method" title="Mapi::Message#populate_headers (method)">#populate_headers</a></span>, <span class='object_link'><a href="../Message.html#to_mime-instance_method" title="Mapi::Message#to_mime (method)">#to_mime</a></span>, <span class='object_link'><a href="../Message.html#to_post-instance_method" title="Mapi::Message#to_post (method)">#to_post</a></span>, <span class='object_link'><a href="../Message.html#to_tmail-instance_method" title="Mapi::Message#to_tmail (method)">#to_tmail</a></span>, <span class='object_link'><a href="../Message.html#to_vcard-instance_method" title="Mapi::Message#to_vcard (method)">#to_vcard</a></span></p>

  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(desc, list, type = nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Mapi::Pst::Item (class)">Item</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Item.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1539
1540
1541
1542
1543
1544
1545
1546
1547
1548
1549
1550
1551
1552
1553
1554
1555
1556
1557
1558
1559
1560
1561
1562
1563
1564
1565
1566
1567
1568
1569</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1539</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span> <span class='id identifier rubyid_list'>list</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='op'>=</span><span class='kw'>nil</span>
	<span class='ivar'>@desc</span> <span class='op'>=</span> <span class='id identifier rubyid_desc'>desc</span>
	<span class='kw'>super</span> <span class='const'><span class='object_link'><a href="../Pst.html" title="Mapi::Pst (class)">Pst</a></span></span><span class='period'>.</span><span class='id identifier rubyid_make_property_set'><span class='object_link'><a href="../Pst.html#make_property_set-class_method" title="Mapi::Pst.make_property_set (method)">make_property_set</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_list'>list</span><span class='rparen'>)</span>

	<span class='comment'># this is kind of weird, but the ids of the special folders are stored in a hash
</span>	<span class='comment'># when the root item is loaded
</span>	<span class='kw'>if</span> <span class='id identifier rubyid_ipm_wastebasket_entryid'>ipm_wastebasket_entryid</span>
		<span class='id identifier rubyid_desc'>desc</span><span class='period'>.</span><span class='id identifier rubyid_pst'>pst</span><span class='period'>.</span><span class='id identifier rubyid_special_folder_ids'>special_folder_ids</span><span class='lbracket'>[</span><span class='id identifier rubyid_ipm_wastebasket_entryid'>ipm_wastebasket_entryid</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='symbol'>:wastebasket</span>
	<span class='kw'>end</span>

	<span class='kw'>if</span> <span class='id identifier rubyid_finder_entryid'>finder_entryid</span>
		<span class='id identifier rubyid_desc'>desc</span><span class='period'>.</span><span class='id identifier rubyid_pst'>pst</span><span class='period'>.</span><span class='id identifier rubyid_special_folder_ids'>special_folder_ids</span><span class='lbracket'>[</span><span class='id identifier rubyid_finder_entryid'>finder_entryid</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='symbol'>:finder</span>
	<span class='kw'>end</span>

	<span class='comment'># and then here, those are used, along with a crappy heuristic to determine if we are an
</span>	<span class='comment'># item
</span><span class='embdoc_beg'>=begin
</span><span class='embdoc'>i think the low bits of the desc_id can give some info on the type.
</span><span class='embdoc'>
</span><span class='embdoc'>it seems that 0x4 is for regular messages (and maybe contacts etc)
</span><span class='embdoc'>0x2 is for folders, and 0x8 is for special things like rules etc, that aren&#39;t visible.
</span><span class='embdoc_end'>=end
</span>	<span class='kw'>unless</span> <span class='id identifier rubyid_type'>type</span>
		<span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_valid_folder_mask'>valid_folder_mask</span> <span class='op'>||</span> <span class='id identifier rubyid_ipm_subtree_entryid'>ipm_subtree_entryid</span> <span class='op'>||</span> <span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_content_count'>content_count</span> <span class='op'>||</span> <span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_subfolders'>subfolders</span> <span class='op'>?</span> <span class='symbol'>:folder</span> <span class='op'>:</span> <span class='symbol'>:message</span>
		<span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:folder</span>
			<span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_desc'>desc</span><span class='period'>.</span><span class='id identifier rubyid_pst'>pst</span><span class='period'>.</span><span class='id identifier rubyid_special_folder_ids'>special_folder_ids</span><span class='lbracket'>[</span><span class='id identifier rubyid_desc'>desc</span><span class='period'>.</span><span class='id identifier rubyid_desc_id'>desc_id</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_type'>type</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>

	<span class='ivar'>@type</span> <span class='op'>=</span> <span class='id identifier rubyid_type'>type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="parent=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="parent-instance_method">
  
    #<strong>parent</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute parent.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1537
1538
1539</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1537</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parent'>parent</span>
  <span class='ivar'>@parent</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="type=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="type-instance_method">
  
    #<strong>type</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute type.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1537
1538
1539</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1537</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type'>type</span>
  <span class='ivar'>@type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="attachments-instance_method">
  
    #<strong>attachments</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>i think i will change these, so they can inherit the lazyness from RawPropertyStoreTable. so if you want the last attachment, you can get it without creating the others perhaps. it just has to handle the no table at all case a bit more gracefully.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1650
1651
1652</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1650</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attachments'>attachments</span>
	<span class='ivar'>@attachments</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="AttachmentTable.html" title="Mapi::Pst::AttachmentTable (class)">AttachmentTable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="AttachmentTable.html#initialize-instance_method" title="Mapi::Pst::AttachmentTable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='ivar'>@desc</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'><span class='object_link'><a href="AttachmentTable.html#to_a-instance_method" title="Mapi::Pst::AttachmentTable#to_a (method)">to_a</a></span></span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_list'>list</span><span class='op'>|</span> <span class='const'><span class='object_link'><a href="Attachment.html" title="Mapi::Pst::Attachment (class)">Attachment</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Attachment.html#initialize-instance_method" title="Mapi::Pst::Attachment#initialize (method)">new</a></span></span> <span class='id identifier rubyid_list'>list</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="children-instance_method">
  
    #<strong>children</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1607
1608
1609</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1607</span>

<span class='kw'>def</span> <span class='id identifier rubyid_children'>children</span>
	<span class='id identifier rubyid_to_enum'>to_enum</span><span class='lparen'>(</span><span class='symbol'>:each_child</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_child-instance_method">
  
    #<strong>each_child</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1571
1572
1573
1574
1575
1576
1577
1578
1579
1580
1581
1582
1583
1584
1585
1586
1587
1588
1589
1590
1591
1592
1593
1594
1595
1596
1597</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1571</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each_child'>each_child</span>
	<span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_ipm_subtree_entryid'>ipm_subtree_entryid</span>
	<span class='kw'>if</span> <span class='id identifier rubyid_id'>id</span>
		<span class='id identifier rubyid_root'><span class='object_link'><a href="../../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span></span> <span class='op'>=</span> <span class='ivar'>@desc</span><span class='period'>.</span><span class='id identifier rubyid_pst'>pst</span><span class='period'>.</span><span class='id identifier rubyid_desc_from_id'>desc_from_id</span> <span class='id identifier rubyid_id'>id</span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>couldn&#39;t find root</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_root'><span class='object_link'><a href="../../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span></span>
		<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>both kinds of children</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='ivar'>@desc</span><span class='period'>.</span><span class='id identifier rubyid_children'>children</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
		<span class='id identifier rubyid_children'>children</span> <span class='op'>=</span> <span class='id identifier rubyid_root'><span class='object_link'><a href="../../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span></span><span class='period'>.</span><span class='id identifier rubyid_children'>children</span>
		<span class='comment'># lets look up the other ids we have.
</span>		<span class='comment'># typically the wastebasket one &quot;deleted items&quot; is in the children already, but
</span>		<span class='comment'># the search folder isn&#39;t.
</span>		<span class='id identifier rubyid_extras'>extras</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_ipm_wastebasket_entryid'>ipm_wastebasket_entryid</span><span class='comma'>,</span> <span class='id identifier rubyid_finder_entryid'>finder_entryid</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span>
			<span class='id identifier rubyid_root'><span class='object_link'><a href="../../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span></span> <span class='op'>=</span> <span class='ivar'>@desc</span><span class='period'>.</span><span class='id identifier rubyid_pst'>pst</span><span class='period'>.</span><span class='id identifier rubyid_desc_from_id'>desc_from_id</span> <span class='id identifier rubyid_id'>id</span>
			<span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>couldn&#39;t find root for id </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_root'><span class='object_link'><a href="../../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span></span>
			<span class='id identifier rubyid_root'><span class='object_link'><a href="../../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span></span>
		<span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
		<span class='comment'># i do this instead of union, so as not to mess with the order of the
</span>		<span class='comment'># existing children.
</span>		<span class='id identifier rubyid_children'>children</span> <span class='op'>+=</span> <span class='lparen'>(</span><span class='id identifier rubyid_extras'>extras</span> <span class='op'>-</span> <span class='id identifier rubyid_children'>children</span><span class='rparen'>)</span>
		<span class='id identifier rubyid_children'>children</span>
	<span class='kw'>else</span>
		<span class='ivar'>@desc</span><span class='period'>.</span><span class='id identifier rubyid_children'>children</span>
	<span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_desc'>desc</span><span class='op'>|</span>
		<span class='id identifier rubyid_item'>item</span> <span class='op'>=</span> <span class='ivar'>@desc</span><span class='period'>.</span><span class='id identifier rubyid_pst'>pst</span><span class='period'>.</span><span class='id identifier rubyid_pst_parse_item'>pst_parse_item</span><span class='lparen'>(</span><span class='id identifier rubyid_desc'>desc</span><span class='rparen'>)</span>
		<span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='kw'>self</span>
		<span class='kw'>yield</span> <span class='id identifier rubyid_item'>item</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_recursive-instance_method">
  
    #<strong>each_recursive</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1659
1660
1661
1662
1663
1664
1665
1666</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1659</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each_recursive'>each_recursive</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='comment'>#p :self =&gt; self
</span>	<span class='id identifier rubyid_children'>children</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_child'>child</span><span class='op'>|</span>
		<span class='comment'>#p :child =&gt; child
</span>		<span class='id identifier rubyid_block'>block</span><span class='lbracket'>[</span><span class='id identifier rubyid_child'>child</span><span class='rbracket'>]</span>
		<span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_each_recursive'>each_recursive</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="finder_entryid-instance_method">
  
    #<strong>finder_entryid</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Search Root Record</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1624
1625
1626</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1624</span>

<span class='kw'>def</span> <span class='id identifier rubyid_finder_entryid'>finder_entryid</span>
	<span class='ivar'>@finder_entryid</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Item/EntryID.html" title="Mapi::Pst::Item::EntryID (class)">EntryID</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Item/EntryID.html#initialize-instance_method" title="Mapi::Pst::Item::EntryID#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_finder_entryid'>finder_entryid</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_id'><span class='object_link'><a href="Item/EntryID.html#id-instance_method" title="Mapi::Pst::Item::EntryID#id (method)">id</a></span></span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1668
1669
1670
1671
1672
1673
1674
1675
1676
1677</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1668</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
	<span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>display_name</span><span class='words_sep'> </span><span class='tstring_content'>subject</span><span class='words_sep'> </span><span class='tstring_content'>sender_name</span><span class='words_sep'> </span><span class='tstring_content'>subfolders</span><span class='tstring_end'>]</span></span>
<span class='comment'>#			attrs = %w[display_name valid_folder_mask ipm_wastebasket_entryid finder_entryid content_count subfolders]
</span>	<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='id identifier rubyid_a'>a</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_b'>b</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span> <span class='op'>*</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span>

	<span class='id identifier rubyid_type_s'>type_s</span> <span class='op'>=</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:message</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Message</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:folder</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Folder</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_capitalize'>capitalize</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Folder</span><span class='tstring_end'>&#39;</span></span>
	<span class='id identifier rubyid_str2'>str2</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>desc_id=0x%x</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='ivar'>@desc</span><span class='period'>.</span><span class='id identifier rubyid_desc_id'>desc_id</span>

	<span class='op'>!</span><span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Pst::</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type_s'>type_s</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_str2'>str2</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_str'>str</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Pst::</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type_s'>type_s</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_str2'>str2</span><span class='embexpr_end'>}</span><span class='tstring_content'> props=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span> <span class='comment'>#\n&quot; + props.transport_message_headers + &quot;&gt;&quot;
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ipm_subtree_entryid-instance_method">
  
    #<strong>ipm_subtree_entryid</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Top of Personal Folder Record</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1614
1615
1616</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1614</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ipm_subtree_entryid'>ipm_subtree_entryid</span>
	<span class='ivar'>@ipm_subtree_entryid</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Item/EntryID.html" title="Mapi::Pst::Item::EntryID (class)">EntryID</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Item/EntryID.html#initialize-instance_method" title="Mapi::Pst::Item::EntryID#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_ipm_subtree_entryid'>ipm_subtree_entryid</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_id'><span class='object_link'><a href="Item/EntryID.html#id-instance_method" title="Mapi::Pst::Item::EntryID#id (method)">id</a></span></span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ipm_wastebasket_entryid-instance_method">
  
    #<strong>ipm_wastebasket_entryid</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Deleted Items Folder Record</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1619
1620
1621</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1619</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ipm_wastebasket_entryid'>ipm_wastebasket_entryid</span>
	<span class='ivar'>@ipm_wastebasket_entryid</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Item/EntryID.html" title="Mapi::Pst::Item::EntryID (class)">EntryID</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Item/EntryID.html#initialize-instance_method" title="Mapi::Pst::Item::EntryID#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_ipm_wastebasket_entryid'>ipm_wastebasket_entryid</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_id'><span class='object_link'><a href="Item/EntryID.html#id-instance_method" title="Mapi::Pst::Item::EntryID#id (method)">id</a></span></span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="path-instance_method">
  
    #<strong>path</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1599
1600
1601
1602
1603
1604
1605</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1599</span>

<span class='kw'>def</span> <span class='id identifier rubyid_path'>path</span>
	<span class='id identifier rubyid_parents'>parents</span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span>
	<span class='id identifier rubyid_parents'>parents</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span> <span class='id identifier rubyid_item'>item</span> <span class='kw'>while</span> <span class='id identifier rubyid_item'>item</span> <span class='op'>=</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>
	<span class='comment'># remove root
</span>	<span class='id identifier rubyid_parents'>parents</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
	<span class='id identifier rubyid_parents'>parents</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_display_name'>display_name</span> <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unable to construct path</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span> <span class='op'>*</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="recipients-instance_method">
  
    #<strong>recipients</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1654
1655
1656
1657</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/pst.rb', line 1654</span>

<span class='kw'>def</span> <span class='id identifier rubyid_recipients'>recipients</span>
	<span class='comment'>#[]
</span>	<span class='ivar'>@recipients</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="RecipientTable.html" title="Mapi::Pst::RecipientTable (class)">RecipientTable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="RecipientTable.html#initialize-instance_method" title="Mapi::Pst::RecipientTable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='ivar'>@desc</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'><span class='object_link'><a href="RecipientTable.html#to_a-instance_method" title="Mapi::Pst::RecipientTable#to_a (method)">to_a</a></span></span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_list'>list</span><span class='op'>|</span> <span class='const'><span class='object_link'><a href="Recipient.html" title="Mapi::Pst::Recipient (class)">Recipient</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Recipient.html#initialize-instance_method" title="Mapi::Pst::Recipient#initialize (method)">new</a></span></span> <span class='id identifier rubyid_list'>list</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Dec 22 13:41:59 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.6.5).
</div>

    </div>
  </body>
</html>