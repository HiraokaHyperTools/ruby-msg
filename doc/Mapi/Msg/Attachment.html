<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mapi::Msg::Attachment
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mapi::Msg::Attachment";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Mapi.html" title="Mapi (module)">Mapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Msg.html" title="Mapi::Msg (class)">Msg</a></span></span>
     &raquo; 
    <span class="title">Attachment</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mapi::Msg::Attachment
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../Attachment.html" title="Mapi::Attachment (class)">Attachment</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../Item.html" title="Mapi::Item (class)">Item</a></span></li>
          
            <li class="next"><span class='object_link'><a href="../Attachment.html" title="Mapi::Attachment (class)">Attachment</a></span></li>
          
            <li class="next">Mapi::Msg::Attachment</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mapi/msg.rb</dd>
  </dl>
  
</div>





  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#obj-instance_method" title="#obj (instance method)">#<strong>obj</strong>  &#x21d2; Ole::Storage::Dirent </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#properties-instance_method" title="#properties (instance method)">#<strong>properties</strong>  &#x21d2; Object </a>
    

    
      (also: #props)
    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute properties.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(obj)  &#x21d2; Attachment </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Attachment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#valid%3F-instance_method" title="#valid? (instance method)">#<strong>valid?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../Attachment.html" title="Mapi::Attachment (class)">Attachment</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Attachment.html#data-instance_method" title="Mapi::Attachment#data (method)">#data</a></span>, <span class='object_link'><a href="../Attachment.html#filename-instance_method" title="Mapi::Attachment#filename (method)">#filename</a></span>, <span class='object_link'><a href="../Attachment.html#inspect-instance_method" title="Mapi::Attachment#inspect (method)">#inspect</a></span>, <span class='object_link'><a href="../Attachment.html#save-instance_method" title="Mapi::Attachment#save (method)">#save</a></span>, <span class='object_link'><a href="../Attachment.html#to_mime-instance_method" title="Mapi::Attachment#to_mime (method)">#to_mime</a></span>, <span class='object_link'><a href="../Attachment.html#to_tmail-instance_method" title="Mapi::Attachment#to_tmail (method)">#to_tmail</a></span></p>

  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(obj)  &#x21d2; <tt><span class='object_link'><a href="" title="Mapi::Msg::Attachment (class)">Attachment</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Attachment.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>obj</span>
      
      
        <span class='type'>(<tt>Ole::Storage::Dirent</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/msg.rb', line 414</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_obj'>obj</span>
	<span class='ivar'>@obj</span> <span class='op'>=</span> <span class='id identifier rubyid_obj'>obj</span>
	<span class='ivar'>@embedded_ole</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@embedded_msg</span> <span class='op'>=</span> <span class='kw'>nil</span>

	<span class='kw'>super</span> <span class='const'><span class='object_link'><a href="../PropertySet.html" title="Mapi::PropertySet (class)">PropertySet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../PropertySet.html#initialize-instance_method" title="Mapi::PropertySet#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="PropertyStore.html" title="Mapi::Msg::PropertyStore (class)">PropertyStore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load'><span class='object_link'><a href="PropertyStore.html#load-class_method" title="Mapi::Msg::PropertyStore.load (method)">load</a></span></span><span class='lparen'>(</span><span class='ivar'>@obj</span><span class='rparen'>)</span><span class='rparen'>)</span>
	<span class='const'><span class='object_link'><a href="../Msg.html" title="Mapi::Msg (class)">Msg</a></span></span><span class='period'>.</span><span class='id identifier rubyid_warn_unknown'><span class='object_link'><a href="../Msg.html#warn_unknown-class_method" title="Mapi::Msg.warn_unknown (method)">warn_unknown</a></span></span> <span class='ivar'>@obj</span>

	<span class='ivar'>@obj</span><span class='period'>.</span><span class='id identifier rubyid_children'>children</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_child'>child</span><span class='op'>|</span>
		<span class='comment'># temp hack. PropertyStore doesn&#39;t do directory properties atm - FIXME
</span>		<span class='kw'>if</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_dir?'>dir?</span> <span class='kw'>and</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=~</span> <span class='const'><span class='object_link'><a href="PropertyStore.html" title="Mapi::Msg::PropertyStore (class)">PropertyStore</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="PropertyStore.html#SUBSTG_RX-constant" title="Mapi::Msg::PropertyStore::SUBSTG_RX (constant)">SUBSTG_RX</a></span></span> <span class='kw'>and</span>
			 <span class='backref'>$1</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>3701</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>and</span> <span class='backref'>$2</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>000d</span><span class='tstring_end'>&#39;</span></span>
			<span class='ivar'>@embedded_ole</span> <span class='op'>=</span> <span class='id identifier rubyid_child'>child</span>
			<span class='kw'>class</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@embedded_ole</span>
				<span class='kw'>def</span> <span class='id identifier rubyid_compobj'>compobj</span>
					<span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_compobj'>compobj</span> <span class='op'>=</span> <span class='kw'>self</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\001CompObj</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
					<span class='id identifier rubyid_compobj'>compobj</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lbracket'>[</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^.{32}([^\x00]+)</span><span class='regexp_end'>/m</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span>
				<span class='kw'>end</span>

				<span class='kw'>def</span> <span class='id identifier rubyid_embedded_type'>embedded_type</span>
					<span class='id identifier rubyid_temp'>temp</span> <span class='op'>=</span> <span class='id identifier rubyid_compobj'>compobj</span> <span class='kw'>and</span> <span class='kw'>return</span> <span class='id identifier rubyid_temp'>temp</span>
					<span class='comment'># try to guess more
</span>					<span class='kw'>if</span> <span class='id identifier rubyid_children'>children</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_child'>child</span><span class='op'>|</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>__(substg|properties|recip|attach|nameid)</span><span class='regexp_end'>/</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>2</span>
						<span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Office Outlook Message</span><span class='tstring_end'>&#39;</span></span>
					<span class='kw'>end</span>
					<span class='kw'>nil</span>
				<span class='kw'>end</span>
			<span class='kw'>end</span>
			<span class='kw'>if</span> <span class='ivar'>@embedded_ole</span><span class='period'>.</span><span class='id identifier rubyid_embedded_type'>embedded_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Office Outlook Message</span><span class='tstring_end'>&#39;</span></span>
				<span class='ivar'>@embedded_msg</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Msg.html" title="Mapi::Msg (class)">Msg</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Msg.html#initialize-instance_method" title="Mapi::Msg#initialize (method)">new</a></span></span> <span class='ivar'>@embedded_ole</span>
			<span class='kw'>end</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="obj-instance_method">
  
    #<strong>obj</strong>  &#x21d2; <tt>Ole::Storage::Dirent</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Ole::Storage::Dirent</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


409
410
411</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/msg.rb', line 409</span>

<span class='kw'>def</span> <span class='id identifier rubyid_obj'>obj</span>
  <span class='ivar'>@obj</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="properties-instance_method">
  
    #<strong>properties</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='props-instance_method'>props</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute properties.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


410
411
412</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/msg.rb', line 410</span>

<span class='kw'>def</span> <span class='id identifier rubyid_properties'>properties</span>
  <span class='ivar'>@properties</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="valid?-instance_method">
  
    #<strong>valid?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


450
451
452
453
454</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/msg.rb', line 450</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid?'>valid?</span>
	<span class='comment'># something i started to notice when handling embedded ole object attachments is
</span>	<span class='comment'># the particularly strange case where there are empty attachments
</span>	<span class='kw'>not</span> <span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Dec 22 00:59:41 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.6.5).
</div>

    </div>
  </body>
</html>