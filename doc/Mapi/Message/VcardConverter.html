<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mapi::Message::VcardConverter
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mapi::Message::VcardConverter";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (V)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Mapi.html" title="Mapi (module)">Mapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Message.html" title="Mapi::Message (class)">Message</a></span></span>
     &raquo; 
    <span class="title">VcardConverter</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mapi::Message::VcardConverter
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Mapi::Message::VcardConverter</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>Vpim</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mapi/convert/contact.rb</dd>
  </dl>
  
</div>


  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="VCARD_MAP-constant" class="">VCARD_MAP =
          <div class="docstring">
  <div class="discussion">
    
<p>a very incomplete mapping, but its a startâ€¦ can&#39;t find where to set a lot of stuff, like zipcode, jobtitle etc</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
	<span class='comment'># these are all standard mapi properties
</span>	<span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span>
		<span class='lbrace'>{</span>
			<span class='symbol'>:given</span>		<span class='op'>=&gt;</span> <span class='symbol'>:given_name</span><span class='comma'>,</span>
			<span class='symbol'>:family</span>		<span class='op'>=&gt;</span> <span class='symbol'>:surname</span><span class='comma'>,</span>
			<span class='symbol'>:fullname</span>	<span class='op'>=&gt;</span> <span class='symbol'>:subject</span>
		<span class='rbrace'>}</span>
	<span class='rbracket'>]</span><span class='comma'>,</span>
	<span class='comment'># outlook seems to eschew the mapi properties this time,
</span>	<span class='comment'># like postal_address, street_address, home_address_city
</span>	<span class='comment'># so we use the named properties
</span>	<span class='symbol'>:addr</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span>
		<span class='lbrace'>{</span>
			<span class='symbol'>:location</span>	<span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>work</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
			<span class='symbol'>:street</span>		<span class='op'>=&gt;</span> <span class='symbol'>:business_address_street</span><span class='comma'>,</span>
			<span class='symbol'>:locality</span>	<span class='op'>=&gt;</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_props'>props</span><span class='op'>|</span>
				<span class='lbracket'>[</span><span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_business_address_city'>business_address_city</span><span class='comma'>,</span> <span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_business_address_state'>business_address_state</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span> <span class='op'>*</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span>
			<span class='kw'>end</span>
		<span class='rbrace'>}</span>
	<span class='rbracket'>]</span><span class='comma'>,</span>

	<span class='comment'># right type? maybe date
</span>	<span class='symbol'>:birthday</span>	<span class='op'>=&gt;</span> <span class='symbol'>:birthday</span><span class='comma'>,</span>
	<span class='symbol'>:nickname</span>	<span class='op'>=&gt;</span> <span class='symbol'>:nickname</span>

	<span class='comment'># photo available?
</span>	<span class='comment'># FIXME finish, emails, telephones etc
</span><span class='rbrace'>}</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#msg-instance_method" title="#msg (instance method)">#<strong>msg</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute msg.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#convert-instance_method" title="#convert (instance method)">#<strong>convert</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#field-instance_method" title="#field (instance method)">#<strong>field</strong>(name, *args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_properties-instance_method" title="#get_properties (instance method)">#<strong>get_properties</strong>(hash)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_property-instance_method" title="#get_property (instance method)">#<strong>get_property</strong>(key)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(msg)  &#x21d2; VcardConverter </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of VcardConverter.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(msg)  &#x21d2; <tt><span class='object_link'><a href="" title="Mapi::Message::VcardConverter (class)">VcardConverter</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of VcardConverter.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/convert/contact.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_msg'>msg</span>
	<span class='ivar'>@msg</span> <span class='op'>=</span> <span class='id identifier rubyid_msg'>msg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="msg-instance_method">
  
    #<strong>msg</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute msg.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/convert/contact.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_msg'>msg</span>
  <span class='ivar'>@msg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="convert-instance_method">
  
    #<strong>convert</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/convert/contact.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_convert'>convert</span>
	<span class='const'>Vpim</span><span class='op'>::</span><span class='const'>Vcard</span><span class='op'>::</span><span class='const'>Maker</span><span class='period'>.</span><span class='id identifier rubyid_make2'>make2</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span>
		<span class='comment'># handle name
</span>		<span class='lbracket'>[</span><span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:addr</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_type'>type</span><span class='op'>|</span>
			<span class='const'><span class='object_link'><a href="#VCARD_MAP-constant" title="Mapi::Message::VcardConverter::VCARD_MAP (constant)">VCARD_MAP</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
				<span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_props'>props</span> <span class='op'>=</span> <span class='id identifier rubyid_get_properties'>get_properties</span><span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='rparen'>)</span>
				<span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>add_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='op'>|</span>
					<span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span> <span class='id identifier rubyid_n'>n</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='rbrace'>}</span>
				<span class='kw'>end</span>
			<span class='kw'>end</span>
		<span class='kw'>end</span>

		<span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#VCARD_MAP-constant" title="Mapi::Message::VcardConverter::VCARD_MAP (constant)">VCARD_MAP</a></span></span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>-</span> <span class='lbracket'>[</span><span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:addr</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
			<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_get_property'>get_property</span> <span class='const'><span class='object_link'><a href="#VCARD_MAP-constant" title="Mapi::Message::VcardConverter::VCARD_MAP (constant)">VCARD_MAP</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
			<span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
		<span class='kw'>end</span>

		<span class='comment'># the rest of the stuff is custom
</span>
		<span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_get_property'>get_property</span><span class='lparen'>(</span><span class='symbol'>:webpage</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_get_property'>get_property</span><span class='lparen'>(</span><span class='symbol'>:business_home_page</span><span class='rparen'>)</span>
		<span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_add_field'>add_field</span> <span class='id identifier rubyid_field'>field</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>URL</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span>
		<span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_add_field'>add_field</span> <span class='id identifier rubyid_field'>field</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>X-EVOLUTION-FILE-AS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_get_property'>get_property</span><span class='lparen'>(</span><span class='symbol'>:file_under</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_get_property'>get_property</span><span class='lparen'>(</span><span class='symbol'>:file_under</span><span class='rparen'>)</span>

		<span class='id identifier rubyid_addr'>addr</span> <span class='op'>=</span> <span class='id identifier rubyid_get_property'>get_property</span><span class='lparen'>(</span><span class='symbol'>:email_email_address</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_get_property'>get_property</span><span class='lparen'>(</span><span class='symbol'>:email_original_display_name</span><span class='rparen'>)</span>
		<span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span>
			<span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_add_email'>add_email</span> <span class='id identifier rubyid_addr'>addr</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
				<span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_format'>format</span> <span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>x400</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_msg'>msg</span><span class='period'>.</span><span class='id identifier rubyid_props'>props</span><span class='period'>.</span><span class='id identifier rubyid_email_addr_type'>email_addr_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMTP</span><span class='tstring_end'>&#39;</span></span>
			<span class='kw'>end</span>
		<span class='kw'>end</span>

		<span class='kw'>if</span> <span class='id identifier rubyid_org'>org</span> <span class='op'>=</span> <span class='id identifier rubyid_get_property'>get_property</span><span class='lparen'>(</span><span class='symbol'>:company_name</span><span class='rparen'>)</span>
			<span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_add_field'>add_field</span> <span class='id identifier rubyid_field'>field</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ORG</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_get_property'>get_property</span><span class='lparen'>(</span><span class='symbol'>:company_name</span><span class='rparen'>)</span><span class='rparen'>)</span>
		<span class='kw'>end</span>

		<span class='comment'># TODO: imaddress
</span>	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="field-instance_method">
  
    #<strong>field</strong>(name, *args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/convert/contact.rb', line 61</span>

<span class='kw'>def</span> <span class='id identifier rubyid_field'>field</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
	<span class='const'>DirectoryInfo</span><span class='op'>::</span><span class='const'>Field</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='const'>Vpim</span><span class='period'>.</span><span class='id identifier rubyid_encode_text_list'>encode_text_list</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_properties-instance_method">
  
    #<strong>get_properties</strong>(hash)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/convert/contact.rb', line 80</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_properties'>get_properties</span> <span class='id identifier rubyid_hash'>hash</span>
	<span class='id identifier rubyid_constants'>constants</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
	<span class='id identifier rubyid_others'>others</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
	<span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_to'>to</span><span class='comma'>,</span> <span class='id identifier rubyid_from'>from</span><span class='op'>|</span>
		<span class='kw'>if</span> <span class='const'>String</span> <span class='op'>===</span> <span class='id identifier rubyid_from'>from</span>
			<span class='id identifier rubyid_constants'>constants</span><span class='lbracket'>[</span><span class='id identifier rubyid_to'>to</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_from'>from</span>
		<span class='kw'>else</span>
			<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_get_property'>get_property</span> <span class='id identifier rubyid_from'>from</span>
			<span class='id identifier rubyid_others'>others</span><span class='lbracket'>[</span><span class='id identifier rubyid_to'>to</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_others'>others</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
	<span class='id identifier rubyid_others'>others</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span> <span class='id identifier rubyid_constants'>constants</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_property-instance_method">
  
    #<strong>get_property</strong>(key)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mapi/convert/contact.rb', line 65</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_property'>get_property</span> <span class='id identifier rubyid_key'>key</span>
	<span class='kw'>if</span> <span class='const'>String</span> <span class='op'>===</span> <span class='id identifier rubyid_key'>key</span>
		<span class='kw'>return</span> <span class='id identifier rubyid_key'>key</span>
	<span class='kw'>elsif</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbol'>:call</span>
		<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span> <span class='id identifier rubyid_msg'>msg</span><span class='period'>.</span><span class='id identifier rubyid_props'>props</span>
	<span class='kw'>else</span>
		<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_msg'>msg</span><span class='period'>.</span><span class='id identifier rubyid_props'>props</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
	<span class='kw'>end</span>
	<span class='kw'>if</span> <span class='const'>String</span> <span class='op'>===</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>and</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
		<span class='kw'>nil</span>
	<span class='kw'>else</span>
		<span class='id identifier rubyid_value'>value</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Dec 22 21:41:54 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.6.5).
</div>

    </div>
  </body>
</html>