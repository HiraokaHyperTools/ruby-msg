<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Mapi::Pst::RawPropertyStore</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>class</span>
Mapi::Pst::RawPropertyStore
</h1>
<ol class='paths'>
<li>
<a href="../../../files/lib/mapi/pst_rb.html">lib/mapi/pst.rb</a>
</li>
</ol>
<div class='parent'>
Superclass:
<strong><a href="BlockParser.html">BlockParser</a></strong>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p><a href="RawPropertyStore.html"><code>RawPropertyStore</code></a> is used to iterate through the properties of an item, or the auxiliary data for an attachment. its just a parser for the way the properties are serialized, when the properties don&#39;t have to conform to a column structure.</p>

<p>structure of this chunk of data is often</p>

<pre>header, property keys, data values, and then indexes.</pre>

<p>the property keys has value in it. value can be the actual value if its a short type, otherwise you lookup the value in the indicies, where you get the offsets to use in the main data body. due to the indirect thing though, any of these parts could actually come from a separate stream.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-new">new</a></li>
</ol>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-each">each</a></li>
<li><a href="#attribute-i-length">length</a></li>
</ol>
</div>
<div id='context'>
<div id='includes'>
<h2>Included modules</h2>
<ol>
<li>Enumerable</li>
</ol>
</div>
</div>
<div id='section'>
<div id='attribute-list'>
<h2 class='section-bar'>Attributes</h2>
<div class='name-list'>
<table>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-length'>length</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'></td>
</tr>
</table>
</div>
</div>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='public-class method' id='method-method-c-new'>
<a name='method-c-new'></a>
<div class='synopsis'>
<span class='name'>new</span><span class='arguments'>(desc)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-new-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-new-source'><span class="ruby-comment"># File lib/mapi/pst.rb, line 1277</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span> <span class="ruby-identifier">desc</span>&#x000A;        <span class="ruby-keyword">super</span>&#x000A;        <span class="ruby-identifier">raise</span> <span class="ruby-constant">FormatError</span>, <span class="ruby-node">&quot;expected type 1 - got #{@type}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@type</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>&#x000A;&#x000A;        <span class="ruby-comment"># the way that offset works, data1 may be a subset of buf, or something from id2. if its from buf,</span>&#x000A;        <span class="ruby-comment"># it will be offset based on index_offset and offset. so it could be some random chunk of data anywhere</span>&#x000A;        <span class="ruby-comment"># in the thing.</span>&#x000A;        <span class="ruby-identifier">header_data</span> = <span class="ruby-identifier">get_data_indirect</span> <span class="ruby-ivar">@offset1</span>&#x000A;        <span class="ruby-identifier">raise</span> <span class="ruby-constant">FormatError</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">header_data</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">8</span>&#x000A;        <span class="ruby-identifier">signature</span>, <span class="ruby-identifier">offset2</span> = <span class="ruby-identifier">header_data</span>.<span class="ruby-identifier">unpack</span> <span class="ruby-string">&#39;V2&#39;</span>&#x000A;        <span class="ruby-comment">#p [@type, signature]</span>&#x000A;        <span class="ruby-identifier">raise</span> <span class="ruby-constant">FormatError</span>, <span class="ruby-string">&#39;unhandled block signature 0x%08x&#39;</span> <span class="ruby-operator">%</span> <span class="ruby-ivar">@type</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">signature</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0x000602b5</span>&#x000A;        <span class="ruby-comment"># this is actually a big chunk of tag tuples.</span>&#x000A;        <span class="ruby-ivar">@index_data</span> = <span class="ruby-identifier">get_data_indirect</span> <span class="ruby-identifier">offset2</span>&#x000A;        <span class="ruby-ivar">@length</span> = <span class="ruby-ivar">@index_data</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">/</span> <span class="ruby-value">8</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Public Instance methods</h2>
<div class='public-instance method' id='method-method-i-each'>
<a name='method-i-each'></a>
<div class='synopsis'>
<span class='name'>each</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>iterate through the property tuples</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-each-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-each-source'><span class="ruby-comment"># File lib/mapi/pst.rb, line 1295</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">each</span>&#x000A;        <span class="ruby-identifier">length</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">key</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">value</span> = <span class="ruby-identifier">handle_indirect_values</span>(<span class="ruby-operator">*</span><span class="ruby-ivar">@index_data</span>[<span class="ruby-value">8</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">i</span>, <span class="ruby-value">8</span>].<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;vvV&#39;</span>))&#x000A;                <span class="ruby-keyword">yield</span> <span class="ruby-identifier">key</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">value</span>&#x000A;        <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/rdoc/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
